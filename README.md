# Vampire Survival Like Game

Игра в стиле Vampire Survivors на Ruby с использованием Ruby2D.

## Установка

1. Убедитесь, что у вас установлен Ruby (рекомендуется версия 3.0+)
2. Установите зависимости:
```bash
bundle install
```

## Запуск

```bash
ruby main.rb
```

## Управление

### В игре:
- **W/↑** - Движение вверх
- **S/↓** - Движение вниз
- **A/←** - Движение влево
- **D/→** - Движение вправо
- **ESC** - Вернуться в главное меню

### В меню:
- **W/↑** - Перемещение вверх по пунктам меню
- **S/↓** - Перемещение вниз по пунктам меню
- **Enter/Space** - Выбрать пункт меню
- **Мышь** - Навигация и выбор

### В настройках:
- **A/←** - Переключение категорий влево / Уменьшение значения
- **D/→** - Переключение категорий вправо / Увеличение значения
- **W/↑** - Перемещение вверх по настройкам
- **S/↓** - Перемещение вниз по настройкам
- **ESC** - Вернуться в главное меню (настройки сохраняются)

## Основные механики

### Система героев
- **Выбор героя** при старте новой игры
- Каждый герой имеет уникальные характеристики:
  - Здоровье
  - Скорость движения
  - Базовый урон
  - Броня
  - Стартовое оружие
- Визуально разные модели для каждого героя

### Система оружия (6 типов)
- **Кнут [W]** - ближний бой, наносит урон в конусе перед игроком, имеет вампиризм
- **Магическая палочка [*]** - дальнобойные магические снаряды
- **Нож [K]** - метательные ножи
- **Топор [A]** - метательные топоры
- **Крест [+]** - возвращающийся бумеранг, вращается вокруг игрока
- **Чеснок [G]** - постоянный урон всем врагам в радиусе

Все оружия автоматически атакуют ближайших врагов и могут быть улучшены до 8 уровня.

### Система пассивных улучшений

#### Базовые пассивки (доступны при повышении уровня):
- **[H] Макс. здоровье** - Увеличивает максимальное здоровье на 20% за уровень (макс. 5 уровней)
- **[S] Скорость движения** - Увеличивает скорость движения на 10% за уровень (макс. 5 уровней)
- **[D] Броня** - Уменьшает получаемый урон на 10% за уровень (макс. 5 уровней)
- **[M] Магнит** - Увеличивает радиус притягивания опыта на 20 пикселей за уровень (макс. 5 уровней)
- **[L] Удача** - Увеличивает шанс получения лучших улучшений (макс. 5 уровней)
- **[X] Рост** - Увеличивает получаемый опыт на 10% за уровень (макс. 5 уровней)
- **[V] Вампиризм** - Восстанавливает здоровье при нанесении урона (макс. 5 уровней)
- **[D] Шанс дропа** - Увеличивает шанс выпадения дропов с врагов (макс. 5 уровней)
- **[⚔️] Урон** - Увеличивает базовый урон всех оружий (макс. 5 уровней)

#### Уникальные пассивки (только из сундуков):
- **[#] Кол-во снарядов** - Увеличивает количество снарядов всех оружий (макс. 5 уровней)
- **[A] Размер оружия** - Увеличивает размер/область всех оружий на 5% за уровень (макс. 5 уровней)
- **[R] Дальность оружия** - Увеличивает дальность всех оружий на 5% за уровень (макс. 5 уровней)
- **[C] Снижение кулдауна** - Уменьшает время между атаками всех оружий на 2% за уровень (макс. 5 уровней)
- **[T] Длительность** - Увеличивает длительность эффектов оружий на 20% за уровень (макс. 5 уровней)

### Система рарности улучшений
Все улучшения имеют рарность, которая влияет на их эффективность:
- **Простое** (серый) - базовая эффективность
- **Редкое** (синий) - +20% к улучшению
- **Эпическое** (фиолетовый) - +50% к улучшению
- **Легендарное** (золотой) - +100% к улучшению

Удача игрока увеличивает шанс получения более высоких рарностей.

### Система прокачки
- **Получение опыта**: За убийство врагов выпадают гемы опыта
- **Притягивание опыта**: Гемы автоматически притягиваются к игроку в радиусе действия магнита
- **Повышение уровня**: При накоплении опыта открывается экран выбора улучшения
- **Типы улучшений при повышении уровня**:
  - Только улучшение существующего оружия/пассива
  - Новые базовые пассивки (если их еще нет)

### Система карты
- **Процедурная генерация карты**:
  - Мини-здания с комнатами и коридорами
  - Природные препятствия (деревья, камни)
  - Декоративные объекты (трава, цветы, кусты)
- **Интерактивные объекты**:
  - **Сундуки** (золотая обводка) - требуют золото для открытия, дают только ценные предметы
  - **Бесплатные сундуки** - открываются без стоимости, появляются после алтарей
  - **Ящики** (коричневая обводка) - можно разрушить атакой, дают опыт и золото
  - **Алтари** (фиолетовая обводка) - вызывают группу элитных мобов, после победы дают бесплатный сундук
  - **Портал** (красная обводка) - вызывает финального босса
- **Коллизии**: Игрок и враги не могут проходить через стены и препятствия
- **Границы карты**: Стены по краям карты
- **Миникарта**: Показывает позицию игрока и интерактивные объекты

### Система золота
- **Получение золота**:
  - За убийство врагов (30% шанс, 1-3 золота)
  - Из сундуков (50-150 золота)
  - Из ящиков (5-15 золота)
- **Использование золота**:
  - Открытие сундуков (прогрессивная стоимость: 50G * 1.5^количество_открытых_сундуков)

### Система сундуков
Сундуки содержат **только очень ценные предметы**:
- **Новое оружие** (50% шанс, если есть доступные)
- **Усиление существующей пушки на +2 уровня** (если нет новых пушек)
- **Особые усиления** (уникальные пассивки) - всегда одна, с повышенной рарностью

Сундуки **НЕ дают** опыт и золото (только если все оружия и пассивки уже максимального уровня).

### Система врагов

#### Обычные враги (появляются автоматически):
- **Скелет** - базовый враг, появляется с начала игры
- **Летучая мышь** - быстрый, слабый враг, появляется с начала игры
- **Призрак** - средний враг, появляется после 2 минут
- **Зомби** - медленный, но сильный враг, появляется после 2 минут
- **Рыцарь-скелет** - сильный дальнобойный враг, появляется после 5 минут
- **Маг-скелет** - сильный дальнобойный враг, появляется после 5 минут

#### Элитные враги (вызываются через алтари):
- **Элитный рыцарь** - ближний бой с индикацией атак
- **Элитный маг** - дальнобойный с индикацией атак

#### Боссы:
- **Обычный босс** - появляется каждые 3 минуты, имеет специальные атаки
- **Финальный босс** - вызывается через портал, очень сильный, имеет сложные паттерны атак

#### Поведение врагов:
- Враги двигаются к игроку и атакуют при приближении
- Все враги наносят урон при толкании игрока (70% от обычного урона)
- Элитные враги и боссы имеют индикацию атак (красные/оранжевые круги)
- Прогрессивная сложность: враги становятся сильнее со временем

### Система дропов (Pickups)
С врагов могут выпадать специальные дропы (зависит от шанса дропа):
- **Здоровье** - Восстанавливает процент максимального здоровья
- **Бесплатный сундук** - Создает бесплатный сундук на месте дропа
- **Магнит** - Притягивает весь опыт с карты
- **Бомба** - Наносит урон всем врагам в радиусе

### Система волн
Каждую минуту появляется большая волна монстров:
- Количество врагов в волне увеличивается со временем
- В волнах появляются элитные мобы
- Волны имеют повышенную сложность (+20%)

### Система рекордов
- Игра автоматически сохраняет рекорды
- Отслеживается:
  - Количество убитых врагов
  - Время выживания
  - Достигнутый уровень
  - Количество золота
  - Количество оружий и пассивок
  - Завершена ли игра (убит финальный босс)
- Сохраняется топ-10 результатов в `records.json`
- Лучший результат сохраняется в `high_score.json`

### Визуальные эффекты
- **Анимированные спрайты**:
  - Анимация простоя (idle)
  - Анимация ходьбы (walk)
  - Анимация атаки (attack)
  - Анимация получения урона (damage)
- **Эффекты атаки**:
  - Визуальные эффекты для разных типов оружия
  - Индикация атак элитных врагов и боссов
- **UI элементы**:
  - Полоски здоровья для игрока и врагов
  - Полоска здоровья для боссов
  - Полоска опыта
  - Индикаторы прогресса для сундуков и ящиков
  - Экран выбора улучшений с рарностью
  - Экран выбора героя с описаниями
  - Миникарта
  - Статистика игрока

### Аудио
- **Фоновая музыка** (если включена в настройках)
- **Звуковые эффекты**:
  - Звуки атак игрока и врагов
  - Звуки попадания по врагам
  - Звуки смерти врагов
  - Звуки открытия сундуков
  - Звуки взрыва бочек
  - Звуки сбора опыта
  - Звуки повышения уровня
  - Звуки появления боссов
  - Звуки выбора улучшений

## Уровни сложности

- **Easy (Легко)**: Медленный спавн, меньше врагов, медленные враги, быстрый игрок
- **Normal (Нормально)**: Стандартные параметры
- **Hard (Сложно)**: Быстрый спавн, много врагов, быстрые враги, медленный игрок

## Прогрессивная сложность

Сложность игры увеличивается со временем:
- Скорость спавна врагов увеличивается
- Скорость врагов увеличивается
- Максимальное количество врагов увеличивается
- Здоровье и урон врагов увеличиваются
- Это создает постоянный вызов и требует стратегического выбора улучшений

## Структура проекта

```
.
├── main.rb                 # Точка входа
├── Gemfile                 # Зависимости
├── README.md              # Этот файл
├── BALANCE_CHANGES.md     # История изменений баланса
├── settings.json          # Сохраненные настройки (создается автоматически)
├── high_score.json        # Лучший результат (создается автоматически)
├── records.json           # Топ-10 результатов (создается автоматически)
├── sounds/                # Звуковые эффекты
│   ├── attack.wav
│   ├── enemy_death.wav
│   ├── level_up.wav
│   └── ...
└── lib/
    ├── game.rb            # Основная игровая логика
    ├── player.rb          # Игрок
    ├── enemy.rb           # Враги
    ├── enemy_types.rb     # Типы врагов и их характеристики
    ├── weapon.rb          # Система оружия
    ├── passive.rb         # Пассивные улучшения
    ├── projectile.rb      # Снаряды
    ├── pickup.rb          # Система дропов
    ├── map.rb             # Генерация карты
    ├── map_object.rb      # Объекты на карте
    ├── camera.rb          # Камера
    ├── menu.rb            # Главное меню
    ├── hero_selection.rb  # Выбор героя
    ├── upgrade_screen.rb  # Экран улучшений
    ├── upgrade_system.rb  # Система улучшений
    ├── vs_upgrade_system.rb # Система улучшений в стиле VS
    ├── settings.rb        # Настройки
    ├── settings_screen.rb  # Экран настроек
    ├── game_state_manager.rb # Менеджер состояний игры
    ├── sprite_renderer.rb  # Рендеринг спрайтов
    ├── animation.rb        # Анимации
    ├── ui_enhancer.rb     # Улучшения UI
    └── audio_manager.rb   # Аудио менеджер
```

## Технологии

- **Ruby** - основной язык программирования
- **Ruby2D** - библиотека для графики и игрового цикла
- **JSON** - для сохранения настроек и рекордов

## Особенности реализации

- Полная система коллизий с картой
- Оптимизированный рендеринг (только видимые объекты)
- Система камеры, следующей за игроком
- Процедурная генерация карты
- Система рарности улучшений
- Прогрессивная сложность
- Система рекордов
- Полная поддержка звука

## Лицензия

Этот проект создан в образовательных целях.
